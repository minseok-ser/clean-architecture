의존성 역전하기
--------------

### 단일 책임 원칙
> "하나의 컴포넌트는 한 가지 일만 하고, 올바르게 수행해야 한다."   
> "컴포넌트를 변경하는 이유는 오직 하나뿐이어야 한다."

그러나 의존성에 의해 변경할 이유가 '전파'된다 (하나가 바뀌면 다른 것도 바뀌어야 한다)   
(그림) E는 다른 컴포넌트에 의존하지 않기 때문에 E만 바뀌어도 되지만, A는 E가 바뀔 때 한꺼번에 바뀌어야 한다.   
점선: 이행적 A->B, B->C이면 A->C   

### 사이드 이펙트
컴포넌트 변경시 예측하지 못한 기능 오류가 발생할 수 있음

### 의존성 역전 원칙
계층형에서는 퍼스펙티브가 변경되면 도메인, 웹도 변경되어야 함 (의존성)   

> "코드상의 어떤 의존성이든 그 방향을 역전시킬 수 있다."

양쪽 코드를 모두 제어할 수 있을 때에만 역전 가능 (서드파티 라이브러리 등은 불가능)   
   
도메인 계층에 리포지토리 인터페이스와 엔티티를 만들고, 퍼스펙티브 계층에서 실제 리포지토리를 관리   

### 클린 아키텍처
도메인에서 바깥쪽으로 향하는 의존성은 없고, 바깥쪽에서 도메인으로 향하는 의존성만 있음   
외부 -> 컨트롤러/게이트웨이/프레젠터 -> 유스케이스(서비스) -> 엔티티   
유스케이스는 단일책임을 갖는 서비스 - 넓은 서비스 문제 극복   
도메인 코드는 다른 프레임워크를 알 수 없으므로 모델링이 자유로움   
   
엔티티에 대한 모델을 각 계층에서 유지보수해야 함   
ORM을 사용할 경우, ORM은 퍼스펙티브를 묘사하는 엔티티 클래스가 별도로 필요, 도메인은 다른 계층을 모르기 때문에 별도로 엔티티 클래스가 필요, 두 엔티티를 서로 변환해야 함   
-> 결합이 제거된 상태 

### 육각형 아키텍처
외부 (웹어댑터/외부시스템어댑터/영속성어댑터) -> 입출력 포트 <- 유스케이스 -> 엔티티   
육각형 안에 유스케이스와 엔티티가 있고, 바깥에 '외부'가 있다   
입력포트: app 주도, 출력포트: app 추종
